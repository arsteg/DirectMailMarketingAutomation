<UserControl x:Class="MailMergeUI.PdfTemplateCreator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:sync="http://schemas.syncfusion.com/wpf"
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf">
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Background="White" Padding="12" BorderBrush="#DDD" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Button Content="Load Word" Margin="0,0,10,0" Padding="12,6" Click="LoadWord_Click"/>
                <ComboBox x:Name="FormFieldComboBox" Width="180" Margin="0,0,10,0" SelectedIndex="0" SelectionChanged="FormFieldComboBox_SelectionChanged"/>
                <ComboBox x:Name="DateFieldComboBox" Width="160" Margin="0,0,10,0" SelectedIndex="0" SelectionChanged="DateFieldComboBox_SelectionChanged"/>
                <TextBox x:Name="TemplateNameTextBox" Width="200" Text="My Template" TextChanged="TemplateNameTextBox_TextChanged"/>
                <Button x:Name="ExportButton" Content="Export PDF" Margin="16,0" Padding="20,8" Background="#1976D2" Foreground="White" FontWeight="SemiBold" Click="ExportPdf_Click"/>
                <Button Content="Preview with CSV" Margin="10,0" Click="LoadCSV_Click"/>
            </StackPanel>
        </Border>

        <!-- Rich Text Editor -->
        <sync:SfRichTextBoxAdv x:Name="RichTextEditor" 
                               Grid.Row="1" 
                               Margin="10"
                               Background="White"
                               FontFamily="Calibri"
                               FontSize="14"/>

        <!-- CSV Preview -->
        <wv2:WebView2 x:Name="PdfWebView" Grid.Row="1" Visibility="Collapsed"/>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#EEE" Padding="12" BorderBrush="#DDD" BorderThickness="0,1,0,0">
            <DockPanel>
                <TextBlock Text="Ready" x:Name="StatusText"/>
                <Button Content="Back to Editor" HorizontalAlignment="Right" Click="BackButton_Click" Visibility="Collapsed" x:Name="BackButton"/>
            </DockPanel>
        </Border>
    </Grid>
</UserControl>